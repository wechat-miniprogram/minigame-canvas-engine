<script lang="ts">
import { defineComponent } from "vue";
import { template } from "dot";
let tpl = `
<scrollview id="container" scrollY = "true">
    <text class="text lineHeightText" value="æ–‡æœ¬å¯ä»¥æŒ‡å®šè¡Œé«˜å®žçŽ°åž‚ç›´å±…ä¸­"></text>
  
    <text class="text fontSizeText" value="æ–‡æœ¬å¯ä»¥æŒ‡å®šå­—ä½“å¤§å°"></text>
  
    <text class="text fontFamilyText" value="æ–‡æœ¬å¯ä»¥æŒ‡å®šå­—ä½“ï¼Œæ¯”å¦‚è¿™æ˜¯ä»¿å®‹ä½“"></text>
  
    <text class="text textAlignText" value="æ–‡æœ¬å¯ä»¥æŒ‡å®šæ¨ªå‘å¯¹é½æ–¹å¼ï¼Œæ¯”å¦‚å³å¯¹é½"></text>
  
    <view class="textBox">
      <text class="text verticalAlignText" value="æ–‡æœ¬å¯ä»¥æŒ‡å®šçºµå‘å¯¹é½æ–¹å¼ï¼Œæ¯”å¦‚åº•éƒ¨å¯¹é½"></text>
      <image src="https://res.wx.qq.com/wechatgame/product/webpack/userupload/20191119/wegoing.jpeg" class="wegoing"></image>
    </view>
    <text class="text colorText" value="æ–‡æœ¬å¯ä»¥è®¾ç½®é¢œè‰²"></text>
  
    <text class="text textOverflowText" value="å¾ˆé•¿å¾ˆé•¿å¾ˆé•¿çš„æ–‡æœ¬å¯ä»¥è®¾ç½®æˆªæ–­æ–¹å¼ï¼Œæ¯”å¦‚è¿™æ®µæ–‡å­—è¶…å‡ºå±å¹•ï¼Œä½†æ˜¯ä¼šçœç•¥å·å±•ç¤º"></text>

    <text class="text textStroke" value="æ–‡å­—å¯ä»¥æè¾¹ï¼Œä¸€å®šç¨‹åº¦ä¸Šå°±ä¸éœ€è¦BitMapText"></text>

    <text class="text textShadow" value="æ–‡å­—å¯ä»¥è®¾ç½®é˜´å½±æ•ˆæžœï¼Œä¸€å®šç¨‹åº¦ä¸Šä¹Ÿä¸éœ€è¦BitMapText"></text>

    <text class="text normalWrap" value="è¿™æ˜¯ä¸€æ®µå¾ˆé•¿çš„æ–‡æœ¬ï¼Œåœ¨è®¾ç½®äº†æ–‡å­—å®½åº¦çš„æ—¶å€™ä¼šè‡ªåŠ¨æ¢è¡Œï¼Œè¿™æ˜¯ä¸ºäº†æµ‹è¯•æ–‡æœ¬çš„è‡ªåŠ¨æ¢è¡Œæ•ˆæžœï¼Œå¯ä»¥çœ‹åˆ°æ–‡æœ¬ä¼šåœ¨å®¹å™¨å®½åº¦ä½ç½®è‡ªåŠ¨æ¢è¡Œæ˜¾ç¤º"></text>

    <text class="text normalWrap" value="- è¿™æ˜¯ä¸€æ®µå¾ˆé•¿çš„æ–‡æœ¬ï¼Œåœ¨è®¾ç½®ç¤ºè®¾ -"></text>

    <text class="text normalWrap" value="å¦‚æžœä½¿ç”¨äº†emojiè¡¨æƒ…ï¼Œå»ºè®®è°¨æ…Žä½¿ç”¨ï¼Œå› ä¸ºemojiè¡¨æƒ…çš„å¤„ç†éžå¸¸å¤æ‚ï¼Œè¯·ç•™æ„ä¼šä¸ä¼šæœ‰emojiè¡¨æƒ…è¢«æˆªæ–­çš„æƒ…å†µðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜Š"></text>

    <text class="text preWrap" value="è¿™æ˜¯ä¸€æ®µä¿ç•™ç©ºæ ¼å’Œæ¢è¡Œçš„æ–‡æœ¬ï¼Œ     å‰é¢æœ‰å¾ˆå¤šç©ºæ ¼
    è¿˜å¯ä»¥æ¢è¡Œï¼Œ  ç©ºæ ¼ä¹Ÿä¼šä¿ç•™"></text>

    <text class="text breakAll" value="ThisIsAVeryLongWordThatShouldBreakIntoMultipleLines"></text>

    <text class="text breakWord" value="https://this-is-a-very-long-url-that-should-break-into-multiple-lines.com"></text>

     <text class="text breakWordLines" value="This is Very long word that should break into multiple lines"></text>
  </scrollview>
  `;

let style = {
  container: {
    width: 800,
    height: 1500,
    backgroundColor: '#f3f3f3',
  },
  text: {
    width: '100%',
    height: 50,
    fontSize: 24,
    marginTop: 20,
  },
  textBox: {
    width: '100%',
    height: 50,
    flexDirection: 'row',
    alignItems: 'flex-end'
  },
  wegoing: {
    width: 50,
    height: 50,
  },
  lineHeightText: {
    height: 100,
    lineHeight: 100,
    verticalAlign: 'middle',
  },
  fontSizeText: {
    fontSize: 36,
  },
  fontFamilyText: {
    fontFamily: 'FangSong'
  },
  textAlignText: {
    textAlign: 'right',
  },
  verticalAlignText: {
    width: 460,
    height: 24,
    marginTop: 0,
    verticalAlign: 'bottom',
  },
  colorText: {
    color: 'red',
  },
  textOverflowText: {
    textOverflow: 'ellipsis',
  },
  textStroke: {
    textStrokeWidth: 1,
    textStrokeColor: 'red',
  },
  textShadow: {
    textShadow: '1px 1px 2px blue',
  },
  normalWrap: {
    width: 400,
    whiteSpace: 'normal',
    height: 200,
  },
  preWrap: {
    width: 400,
    whiteSpace: 'pre-wrap',
    backgroundColor:'#ffffff',
    height: 100,
    textAlign: 'center'
  },
  breakAll: {
    width: 400,
    wordBreak: 'break-all',
    height: 80,
  },
  breakWord: {
    width: 400,
    overflowWrap: 'break-word',
    height: 80,
  },

  breakWordLines: {
    width: 400,
    height: 80,
  }
};

export default defineComponent({
  components: {},
  data() {
    return {};
  },
  mounted() {},

  methods: {
    init() {
      const Layout = (window as any).Layout;

      Layout.init(template(tpl)({}), style);

      let canvas = document.getElementById("text") as HTMLCanvasElement;
      let context = canvas.getContext("2d");

      // è®¾ç½®canvasçš„å°ºå¯¸å’Œæ ·å¼çš„containeræ¯”ä¾‹ä¸€è‡´
      canvas.style.width = 800 / 2 + "px";
      canvas.style.height = 1500 / 2 + "px";
      canvas.width = 800;
      canvas.height = 1500;

      Layout.updateViewPort(canvas.getBoundingClientRect());

      Layout.layout(context);

      const texts = Layout.getElementsByClassName('text');

      console.log('texts', texts)
      texts.forEach((text, index) => {
        if (index % 2 === 1) {
          text.style.backgroundColor = '#ffffff' 
        }
      })
    },
  },
});
</script>
<template>
  <canvas id="text"></canvas>
</template>

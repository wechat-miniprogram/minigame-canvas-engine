<script lang="ts">
import { defineComponent } from "vue";
import { template } from "dot";

let tpl2 = `
<scrollview id="container" scrollY = "true">
  <text class="text lineHeightText" value="æ–‡æœ¬å¯ä»¥æŒ‡å®šè¡Œé«˜å®žçŽ°åž‚ç›´å±…ä¸­"></text>
  
  <text class="text fontSizeText" value="æ–‡æœ¬å¯ä»¥æŒ‡å®šå­—ä½“å¤§å°"></text>

  <text class="text fontFamilyText" value="æ–‡æœ¬å¯ä»¥æŒ‡å®šå­—ä½“ï¼Œæ¯”å¦‚è¿™æ˜¯ä»¿å®‹ä½“(éœ€è¦å½“å‰ç³»ç»Ÿæ”¯æŒ)"></text>

  <text class="text textAlignText" value="æ–‡æœ¬å¯ä»¥æŒ‡å®šæ¨ªå‘å¯¹é½æ–¹å¼ï¼Œæ¯”å¦‚å³å¯¹é½"></text>

  <view class="textBox">
    <text class="text verticalAlignText" value="æ–‡æœ¬å¯ä»¥æŒ‡å®šçºµå‘å¯¹é½æ–¹å¼ï¼Œæ¯”å¦‚åº•éƒ¨å¯¹é½"></text>
    <image src="https://res.wx.qq.com/wechatgame/product/webpack/userupload/20191119/wegoing.jpeg" class="wegoing"></image>
  </view>
  <text class="text colorText" value="æ–‡æœ¬å¯ä»¥è®¾ç½®é¢œè‰²"></text>

  <text class="text normalWrap" value="è®¾ç½®äº†æ–‡æœ¬å®½åº¦ï¼Œæ–‡æœ¬ä¼šæ ¹æ®å®½åº¦è‡ªåŠ¨æ¢è¡Œï¼Œè¿™åœ¨é¡µé¢å®½åº¦æœ‰é™çš„åœºæ™¯ä¸‹éžå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚åœ¨å±•ç¤ºç”¨æˆ·æ˜µç§°çš„æ—¶å€™ï¼Œç”¨æˆ·æ˜µç§°å¯èƒ½æ˜¯å¾ˆé•¿çš„"></text>

  <text class="text normalWrap" value="ðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜ŠðŸ˜Š"></text>

  <text class="text textOverflowText" value="å¾ˆé•¿å¾ˆé•¿å¾ˆé•¿çš„æ–‡æœ¬å¯ä»¥è®¾ç½®æˆªæ–­æ–¹å¼ï¼Œæ¯”å¦‚è¿™æ®µæ–‡å­—è¶…å‡ºå±å¹•ï¼Œä½†æ˜¯ä¼šçœç•¥å·å±•ç¤º"></text>

  <text class="text textMiddle" value="è®¾ç½®äº†æ–‡æœ¬å®½åº¦ï¼Œæ–‡æœ¬ä¼šæ ¹æ®å®½åº¦è‡ªåŠ¨æ¢è¡Œï¼Œæœ‰æ—¶å€™æ¢è¡Œçš„æ–‡æœ¬ä¹Ÿæƒ³è¦åž‚ç›´å±…ä¸­ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®é«˜åº¦å’ŒverticalAlignæ¥å®žçŽ°"></text>

  <text class="text" value="å¦‚æžœæ˜¯ä¸€ä¸ªå¾ˆé•¿çš„è‹±æ–‡å•è¯ï¼Œé»˜è®¤æ˜¯ä¸ä¼šæˆªæ–­çš„ï¼Œæ¯”å¦‚ supercalifragilisticexpialidocious å¯ä»¥å‘çŽ°ç¬¬ä¸€è¡Œæ”¾ä¸ä¸‹ä»–å°±ä¼šæ¢è¡Œ"></text>

  <text class="text textBreakAll" value="å¦‚æžœä½ æƒ³å¿½ç•¥è‹±æ–‡çš„æŽ’ç‰ˆè§„åˆ™ï¼Œæ¯”å¦‚ supercalifragilisticexpialidocious ç¬¬ä¸€è¡Œæ”¾ä¸ä¸‹ä»–ä¹Ÿä¼šå¼ºè¡Œæ¢è¡Œ"></text>

  <text class="text textStroke" value="æ–‡å­—å¯ä»¥æè¾¹ï¼Œä¸€å®šç¨‹åº¦ä¸Šå°±ä¸éœ€è¦BitMapText"></text>

  <text class="text textShadow" value="æ–‡å­—å¯ä»¥è®¾ç½®é˜´å½±æ•ˆæžœï¼Œä¸€å®šç¨‹åº¦ä¸Šä¹Ÿä¸éœ€è¦BitMapText"></text>
</scrollview>
  `;

  
let tpl = `
<scrollview id="container" scrollY = "true">
  <text id="test" class="text normalWrap" value="è®¾ç½®äº†æ–‡æœ¬å®½åº¦ï¼Œæ–‡æœ¬ä¼šæ ¹æ®å®½åº¦è‡ªåŠ¨æ¢è¡Œï¼Œè¿™åœ¨é¡µé¢å®½åº¦æœ‰é™çš„åœºæ™¯ä¸‹éžå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚åœ¨å±•ç¤ºç”¨æˆ·æ˜µç§°çš„æ—¶å€™ï¼Œç”¨æˆ·æ˜µç§°å¯èƒ½æ˜¯å¾ˆé•¿çš„"></text> 
</scrollview>
  `;

let style = {
  container: {
    width: 800,
    height: 1500,
  },
  text: {
    width: '100%',
    fontSize: 28,
    marginTop: 35,
  },
  textBox: {
    width: '100%',
    height: 80,
    flexDirection: 'row',
    alignItems: 'flex-end',
  },
  wegoing: {
    width: 80,
    height: 80,
  },
  lineHeightText: {
    lineHeight: 100,
    verticalAlign: 'middle',
  },
  fontSizeText: {
    fontSize: 36,
  },
  fontFamilyText: {
    fontFamily: 'FangSong'
  },
  textAlignText: {
    textAlign: 'right',
  },
  verticalAlignText: {
    width: 600,
    height: 24,
    marginTop: 0,
    verticalAlign: 'bottom',
  },
  colorText: {
    color: 'red',
  },
  textOverflowText: {
    textOverflow: 'ellipsis',
    whiteSpace: 'nowrap',
  },
  textStroke: {
    textStrokeWidth: 1,
    textStrokeColor: 'red',
  },
  textShadow: {
    textShadow: '1px 1px 2px blue',
  },
  textMiddle: {
    height: 150,
    verticalAlign: 'middle',
  },
  textBreakAll: {
    wordBreak: 'break-all',
  },
  normalWrap: {
    whiteSpace: 'pre-wrap',
    width: 100
  }
};

export default defineComponent({
  components: {},
  data() {
    return {};
  },
  mounted() {},

  methods: {
    init() {
      const Layout = (window as any).Layout;

      Layout.init(template(tpl)({}), style);

      let canvas = document.getElementById("text") as HTMLCanvasElement;
      let context = canvas.getContext("2d");

      // è®¾ç½®canvasçš„å°ºå¯¸å’Œæ ·å¼çš„containeræ¯”ä¾‹ä¸€è‡´
      canvas.style.width = 800 / 2 + "px";
      canvas.style.height = 1500 / 2 + "px";
      canvas.width = 800;
      canvas.height = 1500;

      Layout.updateViewPort(canvas.getBoundingClientRect());

      Layout.layout(context);

      const texts = Layout.getElementsByClassName('text');

      texts.forEach((text, index) => {
        if (index % 2 === 1) {
          text.style.backgroundColor = '#f8f8f8' 
        } else {
          text.style.backgroundColor = '#f3f3f3' 
        }
      })

      const test = Layout.getElementById('test');
      test.value = `è¿™æ˜¯å¾ˆé•¿çš„      æ–‡å­—å¾ˆé•¿å¾ˆé•¿   
      3
      
      4
      
      5
      6`
    },
  },
});
</script>
<template>
  <canvas id="text"></canvas>
</template>
